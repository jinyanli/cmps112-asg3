<html lang="en">
<head>
<title>Smalltalk-in-Smalltalk - GNU Smalltalk User's Guide</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU Smalltalk User's Guide">
<meta name="generator" content="makeinfo 4.8">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Packages.html#Packages" title="Packages">
<link rel="prev" href="Blox.html#Blox" title="Blox">
<link rel="next" href="Database.html#Database" title="Database">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.2 or any later version published by the Free Software
     Foundation; with no Invariant Sections, with no Front-Cover Texts,
     and with no Back-Cover Texts.  A copy of the license is included
     in the section entitled ``GNU Free Documentation License''.
   -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<p>
<a name="Smalltalk-in-Smalltalk"></a>
<a name="Smalltalk_002din_002dSmalltalk"></a>
Next:&nbsp;<a rel="next" accesskey="n" href="Database.html#Database">Database</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Blox.html#Blox">Blox</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Packages.html#Packages">Packages</a>
<hr>
</div>

<h3 class="section">3.2 The Smalltalk-in-Smalltalk library</h3>

<p>The Smalltalk-in-Smalltalk library is a set of classes for looking at
Smalltalk code, constructing models of Smalltalk classes that can later
be created for real, analyzing and performing changes to the image,
finding smelly code and automatically doing repetitive changes. 
This package incredibly enhances the reflective capabilities of Smalltalk.

   <p>A fundamental part of the system is the recursive-descent parser which
creates parse nodes in the form of instances of subclasses of
<code>RBProgramNode</code>.

   <p>The parser's extreme flexibility can be exploited in three ways, all of
which are demonstrated by source code available in the distribution:

     <ul>
<li>First, actions are not hard-coded in the parser itself: the parser
creates a parse tree, then hands it to methods in <code>RBParser</code> that
can be overridden in different <code>RBParser</code> subclasses.  This is done
by the compiler itself, in which a subclass of <code>RBParser</code> (class
<code>STFileInParser</code>) hands the parse trees to the <code>STCompiler</code>
class.

     <li>Second, an implementation of the &ldquo;visitor&rdquo; pattern is provided to help
in dealing with parse trees created along the way; this approach is
demonstrated by the Smalltalk code pretty-printer in class
<code>RBFormatter</code>, by the syntax highlighting engine included
with the browser, and by the compiler.

     <li>The parser is able to perform complex tree searches and rewrites,
through the ParseTreeSearcher and ParseTreeRewriter classes. 
</ul>

   <p>In addition, two applications were created on top of this library
which are specific to <span class="sc">gnu</span> Smalltalk.  The first is a compiler for Smalltalk
methods written in Smalltalk itself, whose source code provides good
insights into the <span class="sc">gnu</span> Smalltalk virtual machine.

   <p>The second is the automatic documentation extractor, contained in two
files, <samp><span class="file">packages/stinst/compiler/STLoader.st</span></samp> and
<samp><span class="file">packages/stinst/compiler/STLoaderObjs.st</span></samp>.  To be able to create
Texinfo files even if the library cannot be loaded (for example,
<code>BLOX</code> requires a running X server) Smalltalk source code is
interpreted and objects for the classes and methods being read in are
created; then, polymorphism allows one to treat these exactly like usual
classes which can be fed to <span class="sc">gnu</span> Smalltalk's <code>ClassPublisher</code> (found in
<samp><span class="file">packages/stinst/doc/Publish.st</span></samp>.

   </body></html>

