<html lang="en">
<head>
<title>Invoking code blocks - GNU Smalltalk User's Guide</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU Smalltalk User's Guide">
<meta name="generator" content="makeinfo 4.8">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Code-blocks-_0028II_0029.html#Code-blocks-_0028II_0029" title="Code blocks (II)">
<link rel="prev" href="Intervals.html#Intervals" title="Intervals">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.2 or any later version published by the Free Software
     Foundation; with no Invariant Sections, with no Front-Cover Texts,
     and with no Back-Cover Texts.  A copy of the license is included
     in the section entitled ``GNU Free Documentation License''.
   -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<p>
<a name="Invoking-code-blocks"></a>
Previous:&nbsp;<a rel="previous" accesskey="p" href="Intervals.html#Intervals">Intervals</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Code-blocks-_0028II_0029.html#Code-blocks-_0028II_0029">Code blocks (II)</a>
<hr>
</div>

<h4 class="subsection">6.7.3 Invoking code blocks</h4>

<p>Let us revisit the checking example and add a method
for scanning only checks over a certain amount.  This would
allow our user to find &ldquo;big&rdquo; checks, by passing in a value
below which we will not invoke their function.  We will
invoke their code block with the check number as an argument
ment; they can use our existing check: message to get the
amount.

<pre class="example">        Checking extend [
            checksOver: amount do: aBlock
                history keysAndValuesDo: [:key :value |
                    (value &gt; amount)
                           ifTrue: [aBlock value: key]
                ]
        ]
</pre>
   <p>The structure of this loop is much like our printChecks message
sage from chapter 6.  However, in this case we consider each
entry, and only invoke the supplied block if the check's
value is greater than the specified amount.  The line:

<pre class="example">        ifTrue: [aBlock value: key]
</pre>
   <p class="noindent">invokes the user-supplied block, passing as an argument the
key, which is the check number.  The <code>value:</code>
message, when received by a code block, causes the code
block to execute.  Code blocks take <code>value</code>, <code>value:</code>,
<code>value:value:</code>, and <code>value:value:value:</code> messages, so you
can pass from 0 to 3 arguments to a code block.<a rel="footnote" href="#fn-1" name="fnd-1"><sup>1</sup></a>

   <p>You might find it puzzling that an association takes a
<code>value</code> message, and so does a code block.  Remember, each
object can do its own thing with a message.  A code block gets
run when it receives a <code>value</code> message.  An association merely
returns the value part of its key/value pair.  The fact that
both take the same message is, in this case, coincidence.

   <p>Let's quickly set up a new checking account with $250
(wouldn't this be nice in real life?) and write a couple
checks.  Then we'll see if our new method does the job
correctly:
<pre class="example">        mycheck := Checking new.
        mycheck deposit: 250
        mycheck newChecks: 100 count: 40
        mycheck writeCheck: 10
        mycheck writeCheck: 52
        mycheck writeCheck: 15
        mycheck checksOver: 1 do: [:x | x printNl]
        mycheck checksOver: 17 do: [:x | x printNl]
        mycheck checksOver: 200 do: [:x | x printNl]
</pre>
   <p>We will finish this chapter with an alternative way of
writing our <code>checksOver:</code> code.  In this example, we will use
the message <code>select:</code> to pick the checks which exceed our
value, instead of doing the comparison ourselves.  We can
then invoke the new resulting collection against the user's
code block.

<pre class="example">        Checking extend [
            checksOver: amount do: aBlock [
                | chosen |
                chosen := history select: [:amt| amt &gt; amount].
                chosen keysDo: aBlock
            ]
        ]
</pre>
   <p>Note that <code>extend</code> will also overwrite methods.  Try
the same tests as above, they should yield the same result!

   <div class="footnote">
<hr>
<h4>Footnotes</h4><p class="footnote"><small>[<a name="fn-1" href="#fnd-1">1</a>]</small> 
There is also a <code>valueWithArguments:</code> message
which accepts an array holding as many arguments
as you would like.</p>

   <p><hr></div>

   </body></html>

